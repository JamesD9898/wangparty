<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Game Lobby</title>
    <link rel="stylesheet" href="game.css" />
    <link rel="stylesheet" href="../main.css" />
  </head>
  <body>
    <nav>
      <h1>Five Second Rule</h1>
    </nav>
    <section class="main">
      <h2>Question: <span id="question"></span></h2>
      <h2>Time: <span id="time"></span></h2>
      <h2>Up now: <span id="currentPlayer"></span></h2>
      <ul id="answers">
        <li>Answer 1 <span id = "a1"></span></li>
        <li>Answer 2<span id = "a2"></span></li>
        <li>Answer 3<span id = "a3"></span></li>
        <li>Answer 4<span id = "a4"></span></li>
      </ul>
    </section>
    <script>
        const questionDiv = document.getByElementID(question);
        

    </script>
    <section class="vote">
      <h2>Answer 1</h2>
      <div class="vote-buttons">
        <button>Approve</button>
        <button>Reject</button>
      </div>
    </section>
    <section class="chat">
      <h2>Chat</h2>
      <div id="messages"></div>
      <form action="" id="messageForm">
        <input type="text" placeholder="Send a Message" id="messagehere" />
        <button onclick="addnewmessage()">Send</button>
      </form>
    </section>
    <script>
      const messageDiv = document.getElementById("messages");

      messages = [
        { user: "asdlkl;,", message: "Hi" },
        { user: "alex", message: "Hi" },
        { user: "james", message: "Nope" },
      ];
      renderMessages();
      function addnewmessage() {
        const user = getCookieValue("name");
        const messageForm = document.getElementById("messagehere");
        const messageContent = messageForm.value;
        messages.push({ user: user, message: messageContent });
        renderMessages();
        removeFirstMessage();
      }
      function removeFirstMessage() {
        if (messages.length > 7) {
          messages.splice(0, 1);
        }
        renderMessages();
      }
      function renderMessages() {
        messageDiv.innerHTML = "";
        for (let i = 0; i < messages.length; i++) {
          let MessageHTML = ` <p><span class="sender">${messages[i].user}</span> : <span class="message">${messages[i].message}</span></p>`;
          messageDiv.insertAdjacentHTML("beforeend", MessageHTML);
        }
      }
      document
        .getElementById("messageForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();
        });
      function getCookieValue(name) {
        const value = document.cookie
          .split("; ")
          .find((row) => row.startsWith(name + "="))
          ?.split("=")[1];
        return value ? decodeURIComponent(value) : null;
      }
      const Davidname = getCookieValue("name");
      console.log(Davidname);
      document.getElementById("currentPlayer").innerHTML = Davidname;
      async function getGameInfo(){
        const gameInfo = await fetch("/api/gameinfo").then((res) => res.json());
      console.log(gameInfo);
      }
      
    </script>
    <section class = "answering">
        <h2>Answer</h2>
        <div id="messages"></div>
        <form action="" id="messageForm">
        <input type="text" placeholder="Submit answer" id="answerhere" />
        <button onclick="addanswer()">Send</button>
      </form>
    </section>
    <script>
        let answernumber = 0; 

        function addanswer(){
            const user = getCookieValue("name");
            const answerform = document.getByElementID("answerhere");
            const answercontent = answerform.value;

        }

        function renderMessages() {
            messageDiv.innerHTML = "";
          let MessageHTML = ` <p><span class="sender">${messages[i].user}</span> : <span class="message">${messages[i].message}</span></p>`;
          messageDiv.insertAdjacentHTML("beforeend", MessageHTML);
        }
    </script>
  </body>
</html>
